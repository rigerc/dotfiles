#!/bin/bash
# Install Arch Linux packages defined in .chezmoidata/packages.yaml

set -euo pipefail

# Check if running on Arch Linux
if ! command -v pacman &> /dev/null; then
    echo "This script is designed for Arch Linux systems with pacman package manager"
    exit 0
fi

# Function to install package if not already installed
install_package() {
    local package="$1"
    if ! pacman -Qi "$package" &> /dev/null; then
        sudo pacman -S --noconfirm --quiet --needed "$package" >/dev/null
    else
        echo "$package is already installed"
    fi
}

{{- if .packages.arch_packages }}
echo "Installing Arch Linux packages..."
{{- range .packages.arch_packages }}
install_package "{{ . }}"
{{- end }}
echo "Arch Linux packages installation completed"
{{- else }}
echo "No Arch Linux packages defined in packages.yaml"
{{- end }}