#!/bin/bash
set -euo pipefail

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

echo -e "${YELLOW}Installing brews...${NC}"

test -d ~/.linuxbrew && eval "$(~/.linuxbrew/bin/brew shellenv)"
test -d /home/linuxbrew/.linuxbrew && eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"

# Check if brew command is available
if ! command -v brew &> /dev/null; then
    echo -e "${RED}Error: Homebrew is not installed or not in PATH${NC}"
    echo -e "${YELLOW}Please install Homebrew first by running the install-homebrew script${NC}"
    exit 1
fi

echo -e "${GREEN}Homebrew found, proceeding with package installation...${NC}"

# Install Brews
brew bundle --file=/dev/stdin <<EOF
{{ range .packages.brews -}}
brew {{ . | quote }}
{{ end -}}
{{ range .packages.casks -}}
cask {{ . | quote }}
{{ end -}} 
EOF

echo -e "${GREEN}Brew install complete!${NC}"