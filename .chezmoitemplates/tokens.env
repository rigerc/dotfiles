{{- if (stat "~/.bw_session").Exists -}}
export BW_SESSION="{{ (readFile "~/.bw_session" | trim) }}"
{{- end }}

{{- $folderIdOutput := output "bw" "list" "folders" | fromJson -}}
{{- $folderId := "" -}}
{{- range $folderIdOutput -}}
  {{- if eq .name "Tokens" -}}
    {{- $folderId = .id -}}
  {{- end -}}
{{- end -}}
{{- if $folderId -}}
  {{- $tokensOutput := output "bw" "list" "items" "--folderid" $folderId | fromJson -}}
  {{- range $tokensOutput -}}
    {{- $tokenName := .name -}}
    {{- $fieldValue := "" -}}
    {{- if .fields -}}
      {{- range .fields -}}
        {{- if eq .name "Token" -}}
          {{- $fieldValue = .value -}}
        {{- end -}}
      {{- end -}}
    {{- end }}
export {{ $tokenName }}={{ $fieldValue | quote }}
  {{- end -}}
{{- end -}}